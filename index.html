<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mary's Native Product Store System</title>
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Custom Select2 Styles */
        .select2-container--default .select2-selection--single {
            height: 38px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            display: flex;
            align-items: center;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            line-height: 28px;
            padding-left: 8px;
            color: #333;
            width: calc(100% - 20px);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 36px;
            width: 20px;
            position: absolute;
            right: 0;
            top: 0;
        }

        .select2-container {
            width: 100% !important;
            position: relative;
        }

        .select2-container--default .select2-selection--single {
            position: relative;
        }

        /* Fix for form select elements */
        .form-group select,
        .order-section select,
        #salesCategory, 
        #salesSubcategory, 
        #salesSize, 
        #salesUnit,
        #inventoryCategory,
        #inventorySubcategory,
        #inventorySize,
        #inventoryUnit,
        #inventoryMadeFrom,
        #inventoryCooperative,
        #inventoryStorageLocation {
            width: 100% !important;
        }

        /* Ensure Select2 dropdowns match their container width */
        .select2-container--default .select2-selection--single {
            width: 100% !important;
        }

        /* Fix for the dropdown arrow positioning */
        .select2-container--default .select2-selection--single .select2-selection__arrow b {
            border-color: #888 transparent transparent transparent;
            border-style: solid;
            border-width: 5px 4px 0 4px;
            height: 0;
            left: 50%;
            margin-left: -4px;
            margin-top: -2px;
            position: absolute;
            top: 50%;
            width: 0;
        }

        /* Sales Module Styles */
        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .order-item-details {
            display: flex;
            flex-direction: column;
        }

        .order-item-total {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #ff4444;
            cursor: pointer;
            padding: 4px;
        }

        .remove-btn:hover {
            color: #cc0000;
        }

        #inventoryView table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        #inventoryView th {
            background-color: #f5f5f5;
            color: #333;
            font-weight: bold;
            padding: 8px;
            text-align: left;
        }

        #inventoryView td {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        #inventoryView tr:hover {
            background-color: #f9f9f9;
        }

        .receipt-section {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .receipt-total {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #eee;
        }

        .payment-method {
            margin: 15px 0;
        }

        .print-btn {
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .print-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <!-- Authentication Section -->
    <div id="authSection">
        <!-- Login Only (Sign-up Disabled) -->
        <div class="auth-container" id="loginContainer">
            <img src="images/logo2.jpg" alt="Mary's Native Product Store Logo" class="auth-logo">
            <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
            <div class="form-group">
                <input type="text" id="loginUsername" placeholder="Username" required>
            </div>
            <div class="form-group">
                <input type="password" id="loginPassword" placeholder="Password" required>
            </div>
            <div class="form-group">
            <label for="loginRole">Account Type</label>
                <select id="loginRole" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                <option value="admin">System Admin</option>
                <option value="inventory">Inventory Personnel</option>
                <option value="cashier">Cashier</option>
            </select>
            </div>
            <button class="accent-btn" onclick="loginUser()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <p>Accounts must be created by the System Admin.</p>
        </div>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboardSection" style="display: none;">
        <!-- System Notifications Container -->
        <div class="system-notifications"></div>
        
        <!-- User Info Bar -->
        <div class="user-info-bar">
            <div class="system-title">
                <b>Mary's Native Product Store System</b>
            </div>
            <div class="user-controls" style="gap: 16px; justify-content: flex-end;">
                <div class="notification-icon" onclick="showNotifications()" style="cursor: pointer; position: relative;">
                    <i class="fas fa-bell" style="color: #fff; font-size: 18px;"></i>
                    <span id="notificationCount" style="position: absolute; top: -8px; right: -8px; background: #ff4444; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; display: none;">0</span>
                </div>
                <div class="user-role" style="color: #fff;">
                    <i class="fas fa-user"></i> <span id="userRoleText">Admin</span>
                </div>
                <button class="logout-btn" style="margin-left: 16px;" onclick="window.logoutUser()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <!-- Navigation Bar -->
        <nav id="navBar">
            <!-- Logo Space -->
            <div class="logo-space">
                <div class="logo-container">
                    <img src="images/logo2.jpg" alt="Mary's Native Product Store Logo" class="logo">
                </div>
            </div>
            
            <!-- Menu Items -->
            <div class="menu-items">
            <a href="javascript:void(0)" onclick="showModule('dashboardModule')">
                <i class="fa-solid fa-gauge-high"></i>
                <span>Dashboard</span>
            </a>
            <a href="javascript:void(0)" onclick="showModule('salesModule')">
                <i class="fa-solid fa-chart-line"></i>
                <span>Sales</span>
            </a>
            <a href="javascript:void(0)" onclick="showModule('inventoryModule')">
                <i class="fa-solid fa-boxes-stacked"></i>
                <span>Inventory</span>
            </a>
            <a href="javascript:void(0)" onclick="showModule('userManagementModule')">
                <i class="fa-solid fa-users-gear"></i>
                <span>User Management</span>
            </a>
            <a href="javascript:void(0)" onclick="showModule('maintenanceModule')">
                <i class="fa-solid fa-screwdriver-wrench"></i>
                <span>Maintenance</span>
            </a>
            <a href="javascript:void(0)" onclick="showModule('reportsModule')">
                <i class="fa-solid fa-file-lines"></i>
                <span>Reports</span>
            </a>
            </div>
        </nav>

        <!-- Content Area -->
        <div class="content">
            <!-- Dashboard Module -->
            <div id="dashboardModule" class="module">
                <h2>Dashboard</h2>
                <!-- Dashboard Filters -->
                <div class="dashboard-filter">
                    <select id="dashboardDateFilter" onchange="updateDashboard()">
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="year">This Year</option>
                        <option value="custom">Custom Range</option>
                    </select>
                    <input type="date" id="dashboardStartDate" onchange="updateDashboard()">
                    <input type="date" id="dashboardEndDate" onchange="updateDashboard()">
                </div>

                <!-- Metrics Grid -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <h3>Total Sales</h3>
                        <div class="metric-value">₱<span id="totalSalesValue">0.00</span></div>
                        <div class="metric-trend">↑ 12% from last period</div>
                    </div>
                    <div class="metric-card">
                        <h3>Total Orders</h3>
                        <div class="metric-value"><span id="totalOrdersValue">0</span></div>
                        <div class="metric-trend">↑ 8% from last period</div>
                    </div>
                    <div class="metric-card">
                        <h3>Low Stock Items</h3>
                        <div class="metric-value"><span id="lowStockValue">0</span></div>
                        <div class="metric-trend">Requires attention</div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Sales Overview</h3>
                        <div class="chart-filters">
                            <button class="chart-filter-btn active" onclick="updateSalesChart('weekly')">Weekly</button>
                            <button class="chart-filter-btn" onclick="updateSalesChart('monthly')">Monthly</button>
                            <button class="chart-filter-btn" onclick="updateSalesChart('yearly')">Yearly</button>
                        </div>
                        <canvas id="salesOverviewChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>Category Distribution</h3>
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <!-- Bottom Grid -->
                <div class="bottom-grid">
                    <div class="data-card">
                        <h3>Recent Orders</h3>
                        <div class="data-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Date</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recentOrdersBody">
                                    <!-- Recent orders will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3>Top Products</h3>
                        <div class="data-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Category</th>
                                        <th>Units Sold</th>
                                        <th>Revenue</th>
                                    </tr>
                                </thead>
                                <tbody id="topProductsBody">
                                    <!-- Top products will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sales Module -->
            <div id="salesModule" class="module" style="display: none;">
                <h2>Sales</h2>
                <div class="sales-container" style="display: flex; flex-direction: column; align-items: flex-start; gap: 18px; margin-left: 0; width: 100%;">
                    <!-- Top Row: Item Inquiry (left) and Item List Table (right) -->
                    <div style="display: flex; flex-direction: row; gap: 18px; width: 100%;">
                        <div class="item-inquiry" style="width: 340px; min-width: 260px; max-width: 400px; margin-bottom: 0;">
                            <h3>Item Inquiry</h3>
                            <div class="search-bar">
                                <input type="text" id="salesInventorySearch" placeholder="Search items...">
                                <button class="search-icon" onclick="searchSalesInventory()" title="Search">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="item-list-table" style="background: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); padding: 12px 16px; width: 540px; min-width: 320px; max-width: 600px;">
                            <h3 style="margin-top:0;">Item list</h3>
                            <div id="inventoryView"></div>
                        </div>
                    </div>
                    <!-- Bottom Row: Order Details (left) and Receipt (right) -->
                    <div style="display: flex; gap: 20px; width: 100%; margin-top: 10px;">
                        <div class="order-section" style="flex: 2; min-width: 320px; max-width: 400px;">
                            <h3>Order Details</h3>
                            <div class="order-fields">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>Order ID: <span id="currentOrderId">ORD-0001</span></span>
                                </div>
                                <label for="salesItemCode">Item Code</label>
                                <input type="text" id="salesItemCode" placeholder="Item Code" readonly>
                                
                                <label for="salesCategory">Category</label>
                                <select id="salesCategory" required class="compact-select">
                                    <option value="">Select Category</option>
                                    <option value="Home Decor">Home Decor</option>
                                    <option value="Kitchenware">Kitchenware</option>
                                    <option value="Cleaning Tools">Cleaning Tools</option>
                                    <option value="Souvenirs">Souvenirs</option>
                                    <option value="Garden">Garden</option>
                                </select>
                                
                                <label for="salesSubcategory">Subcategory</label>
                                <select id="salesSubcategory" required class="compact-select">
                                    <option value="">Select Subcategory</option>
                                </select>
                                
                                <label for="salesSize">Size</label>
                                <select id="salesSize" required class="compact-select">
                                    <option value="">Select Size</option>
                                    <option value="S">Small</option>
                                    <option value="M">Medium</option>
                                    <option value="L">Large</option>
                                    <option value="XL">Extra Large</option>
                                    <option value="XXL">Double Extra Large</option>
                                </select>
                                
                                <label for="salesUnit">Unit</label>
                                <select id="salesUnit" required class="compact-select">
                                    <option value="">Select Unit</option>
                                    <option value="pcs">Pieces</option>
                                    <option value="bundle">Bundle</option>
                                    <option value="box">Box</option>
                                </select>
                                
                                <label for="salesQuantity">Quantity</label>
                                <input type="number" id="salesQuantity" placeholder="Quantity" min="1" required>
                                
                                <button class="add-order-btn" onclick="addToOrder()">Add to Order</button>
                            </div>
                        </div>
                        <div class="receipt-section">
                            <h3>Receipt</h3>
                            <div id="orderItems">
                                <!-- Order items will be populated here -->
                            </div>
                            <div class="receipt-total">
                                <h4>Total Amount: ₱<span id="totalAmount">0.00</span></h4>
                            </div>
                            <div class="payment-method">
                                <label for="paymentMethod">Payment Method</label>
                                <select id="paymentMethod" class="compact-select">
                                    <option value="cash">Cash</option>
                                    <option value="card">Card</option>
                                    <option value="gcash">GCash</option>
                                </select>
                            </div>
                            <div class="receipt-buttons">
                                <button class="print-btn" onclick="printReceipt()">Print Receipt</button>
                                <button class="save-btn" onclick="saveOrder()">Save Order</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Module -->
            <div id="inventoryModule" class="module" style="display: none;">
                <h2>Inventory Management</h2>
                <div class="inventory-container" style="display: flex; flex-direction: column; gap: 20px;">
                    <!-- Inventory Filters and List (Top, full width, with margin) -->
                    <div class="inventory-grid" style="width: 100%; margin-right: 24px;">
                        <h3>Inventory List</h3>
                        <div class="inventory-filters" style="display: flex; gap: 8px; align-items: center; margin-bottom: 10px;">
                            <div style="flex: 1; display: flex; gap: 8px;">
                                <input type="text" id="inventorySearch" placeholder="Search inventory..." style="flex: 1; min-width: 200px;">
                                <button class="small-btn search-btn" onclick="filterInventory()" title="Search Inventory">Search</button>
                                <button class="small-btn" onclick="viewAllInventory()" title="View All Inventory">View All</button>
                            </div>
                        </div>
                        <div id="inventoryList">
                            <!-- Inventory items will be displayed here -->
                        </div>
                    </div>
                    <!-- Add/Edit Inventory Form (Bottom, full width) -->
                    <div class="form-section inventory-form" style="width: 100%; margin-top: 20px;">
                        <h3 id="formTitle">Add New Inventory Item</h3>
                        <form id="addInventoryForm" onsubmit="addOrUpdateInventory(); return false;">
                            <div class="horizontal-form-row">
                                <div class="form-group compact">
                                    <label for="inventoryProductId">Product ID</label>
                                    <input type="text" id="inventoryProductId" maxlength="15" required class="wide-input" placeholder="Product ID">
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryCategory">Category</label>
                                    <select id="inventoryCategory" required class="wide-input">
                                        <option value="">Select Category</option>
                                        <option value="Home Decor">Home Decor</option>
                                        <option value="Kitchenware">Kitchenware</option>
                                        <option value="Cleaning Tools">Cleaning Tools</option>
                                        <option value="Souvenirs">Souvenirs</option>
                                        <option value="Garden">Garden</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventorySubcategory">Subcategory</label>
                                    <select id="inventorySubcategory" required class="wide-input">
                                        <option value="">Select Subcategory</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventorySize">Size</label>
                                    <select id="inventorySize" required class="wide-input">
                                        <option value="">Select Size</option>
                                        <option value="S">Small</option>
                                        <option value="M">Medium</option>
                                        <option value="L">Large</option>
                                        <option value="XL">Extra Large</option>
                                        <option value="XXL">Double Extra Large</option>

                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryMadeFrom">Made from</label>
                                    <select id="inventoryMadeFrom" required class="wide-input">
                                        <option value="">Select Material</option>
                                        <option value="Wood">Wood</option>
                                        <option value="Clay">Clay</option>
                                        <option value="Bamboo">Bamboo</option>
                                        <option value="Metal">Metal</option>
                                        <option value="Fabric">Fabric</option>
                                        <option value="Stone">Stone</option>
                                        <option value="Plastic">Plastic</option>
                                        <option value="Coconut Shell">Coconut Shell</option>
                                        <option value="Glass">Glass</option>
                                        <option value="Leather">Leather</option>
                                        <option value="Ceramic">Ceramic</option>
                                        <option value="Rattan">Rattan</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryCooperative">Cooperative</label>
                                    <select id="inventoryCooperative" required class="wide-input">
                                        <option value="">Select Cooperative</option>
                                        <option value="Cooperative 1">Cooperative 1</option>
                                        <option value="Cooperative 2">Cooperative 2</option>
                                        <option value="Cooperative 3">Cooperative 3</option>
                                        <option value="Cooperative 4">Cooperative 4</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryQuantityAvailable">Quantity Available</label>
                                    <input type="number" id="inventoryQuantityAvailable" min="0" maxlength="15" required class="wide-input" placeholder="Quantity Available">
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryReorderThreshold">Reorder Threshold</label>
                                    <input type="number" id="inventoryReorderThreshold" min="0" maxlength="15" required class="wide-input" placeholder="Reorder Threshold">
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryStorageLocation">Storage Location</label>
                                    <select id="inventoryStorageLocation" required class="wide-input">
                                        <option value="">Select Storage Location</option>
                                        <option value="Shelf 1">Shelf 1</option>
                                        <option value="Shelf 2">Shelf 2</option>
                                        <option value="Shelf 3">Shelf 3</option>
                                        <option value="Shelf 4">Shelf 4</option>
                                        <option value="Shelf 5">Shelf 5</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryCostPrice">Cost Price</label>
                                    <input type="number" id="inventoryCostPrice" min="0" step="0.01" maxlength="15" required class="wide-input" placeholder="Cost Price">
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryRetailPrice">Retail Price</label>
                                    <input type="number" id="inventoryRetailPrice" min="0" step="0.01" maxlength="15" required class="wide-input" placeholder="Retail Price">
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryUnit">Unit</label>
                                    <select id="inventoryUnit" required class="wide-input">
                                        <option value="">Select Unit</option>
                                        <option value="pcs">pcs</option>
                                        <option value="bundle">bundle</option>
                                        <option value="per box">per box</option>
                                    </select>
                                </div>
                                <div class="form-group compact">
                                    <label for="inventoryDateAdded">Date Added</label>
                                    <input type="date" id="inventoryDateAdded" required class="wide-input" placeholder="Date Added">
                                </div>
                                <div class="form-group compact" style="align-self: flex-end;">
                                    <button class="small-btn add-btn" type="submit" title="Add Inventory Item" style="padding: 6px 12px; font-size: 14px;"><i class="fas fa-plus"></i></button>
                                </div>
                        </div>
                        </form>
                    </div>
                </div>
            </div>

            <style>
                #inventoryList table {
                    width: 100%;
                    border-collapse: collapse;
                }
                #inventoryList table th {
                    background-color: #f5f5f5;
                    color: #333;
                    font-weight: bold;
                }
                #inventoryList table td {
                    color: #2c3e50;
                    padding: 8px;
                }
                #inventoryList table tr:nth-child(even) {
                    background-color: #f9f9f9;
                }
                #inventoryList table tr:hover {
                    background-color: #f5f5f5;
                }
            </style>

            <!-- User Management Module -->
            <div id="userManagementModule" class="module" style="display: none; align-items: flex-start;">
                <h2 style="text-align:left; margin-left:0;">User Management</h2>
                <div class="user-management-container-box" style="width: 1000px; margin-left: 0;">
                    <!-- User List Section -->
                    <div class="user-list-section" style="width: 60%;">
                        <h3>User List</h3>
                        <div class="user-search">
                            <input type="text" id="userSearch" placeholder="Search users..." onkeyup="searchUsers()">
                        </div>
                        <div class="user-table">
                            <!-- Personal Information Table -->
                            <table style="margin-bottom: 18px;">
                                <thead>
                                    <tr>
                                        <th>User ID</th>
                                        <th>Last Name</th>
                                        <th>First Name</th>
                                        <th>Middle Name</th>
                                        <th>Address</th>
                                        <th>Age</th>
                                        <th>Email</th>
                                        <th>Contact #</th>
                                    </tr>
                                </thead>
                                <tbody id="userPersonalList">
                                    <!-- User personal info will be populated here -->
                                </tbody>
                            </table>
                            <!-- User Status Table -->
                            <table>
                                <thead>
                                    <tr>
                                        <th>User ID</th>
                                        <th>Username</th>
                                        <th>Password</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="userStatusList">
                                    <!-- User status info will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- User Form Section -->
                    <div class="user-form-section" style="width: 40%;">
                        <div id="createUserForm">
                            <h3>Create New User</h3>
                            <form onsubmit="createUser(event)">

                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <input type="text" id="newUserId" placeholder="User ID" required style="flex:1; min-width:110px;">
                                    <input type="text" id="newLastName" placeholder="Last Name" required style="flex:1; min-width:110px;">
                                    <input type="text" id="newFirstName" placeholder="First Name" required style="flex:1; min-width:110px;">
                                    <input type="text" id="newMiddleName" placeholder="Middle Name" style="flex:1; min-width:110px;">
                                    <input type="text" id="newAddress" placeholder="Address" style="flex:2; min-width:110px;">
                                    <input type="number" id="newAge" placeholder="Age" min="0" style="flex:1; min-width:70px;">
                                    <input type="email" id="newEmail" placeholder="Email" style="flex:1; min-width:110px;">
                                    <input type="text" id="newContact" placeholder="Contact Number" style="flex:1; min-width:110px;">
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                                    <input type="text" id="newUsername" placeholder="Username" required style="flex:1; min-width:110px;">
                                    <input type="password" id="newPassword" placeholder="Password" required style="flex:1; min-width:110px;">
                                    <input type="password" id="confirmPassword" placeholder="Confirm Password" required style="flex:1; min-width:110px;">
                                    <select id="userRole" required style="flex:1; min-width:110px;">
                                        <option value="">Select Role</option>
                                        <option value="admin">System Admin</option>
                                        <option value="inventory">Inventory Personnel</option>
                                        <option value="cashier">Cashier</option>
                                    </select>
                                </div>
                                <button type="submit" style="margin-top: 10px;">Create User</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Maintenance Module -->
            <div id="maintenanceModule" class="module" style="display: none;">
                <h2>System Maintenance</h2>
                
                <!-- Module Updates Section -->
                <div class="form-section">
                    <h3>Product Configuration</h3>
                    <div class="module-updates">
                        <!-- Product Management -->
                        <div class="update-section">
                            <h4>Product Management</h4>
                            <button class="maintenance-btn" onclick="showItemManager()">Manage Items</button>
                            <button class="maintenance-btn" onclick="showPriceManager()">Manage Prices</button>
                        </div>
                    </div>
                </div>

                <!-- Item Manager Modal -->
                <div id="itemManagerModal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <span class="close" onclick="closeItemManager()">&times;</span>
                        <h3>Manage Items</h3>
                        <div class="item-manager">
                            <!-- Filters -->
                            <div class="filter-controls">
                                <div class="filter-group">
                                    <label>Type:</label>
                                    <select id="itemTypeFilter" onchange="filterItems()">
                                        <option value="">All Types</option>
                                        <option value="category">Categories</option>
                                        <option value="subcategory">Subcategories</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Status:</label>
                                    <select id="itemStatusFilter" onchange="filterItems()">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="archived">Archived</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Items Table -->
                            <div class="items-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Type</th>
                                            <th>Name</th>
                                            <th>Parent Category</th>
                                            <th>Description</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="itemsList">
                                        <!-- Items will be listed here -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Add/Edit Form -->
                            <div class="item-form">
                                <h4 id="formTitle">Add New Item</h4>
                                <form id="itemForm" onsubmit="saveItem(event)">
                                    <input type="hidden" id="itemId">
                                    <div class="form-group">
                                        <label for="itemType">Type</label>
                                        <select id="itemType" required onchange="toggleParentCategory()">
                                            <option value="">Select Type</option>
                                            <option value="category">Category</option>
                                            <option value="subcategory">Subcategory</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="parentCategoryGroup" style="display: none;">
                                        <label for="parentCategory">Parent Category</label>
                                        <select id="parentCategory" required>
                                            <option value="">Select Category</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="itemName">Name</label>
                                        <input type="text" id="itemName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="itemDescription">Description</label>
                                        <textarea id="itemDescription"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" class="save-btn">Save Item</button>
                                        <button type="button" class="cancel-btn" onclick="closeItemManager()">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Price Manager Modal -->
                <div id="priceManagerModal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <span class="close" onclick="closePriceManager()">&times;</span>
                        <h3>Manage Prices</h3>
                        <div class="price-manager">
                            <!-- Filters -->
                            <div class="filter-controls">
                                <div class="filter-group">
                                    <label>Status:</label>
                                    <select id="priceStatusFilter" onchange="filterPrices()">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="expired">Expired</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Prices Table -->
                            <div class="prices-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Item</th>
                                            <th>Category</th>
                                            <th>Price</th>
                                            <th>Effective Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="priceList">
                                        <!-- Prices will be listed here -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Add/Edit Form -->
                            <div class="price-form">
                                <h4 id="priceFormTitle">Set New Price</h4>
                                <form id="priceForm" onsubmit="savePrice(event)">
                                    <input type="hidden" id="priceId">
                                    <div class="form-group">
                                        <label for="priceItem">Item</label>
                                        <select id="priceItem" required>
                                            <option value="">Select Item</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="priceValue">Price</label>
                                        <input type="number" id="priceValue" min="0" step="0.01" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="priceEffectiveDate">Effective Date</label>
                                        <input type="date" id="priceEffectiveDate" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="priceEndDate">End Date (Optional)</label>
                                        <input type="date" id="priceEndDate">
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" class="save-btn">Save Price</button>
                                        <button type="button" class="cancel-btn" onclick="closePriceManager()">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Module -->
            <div id="reportsModule" class="module" style="display: none;">
                <h2>Reports</h2>
                
                <!-- System Logs Section -->
                <div class="report-section">
                    <h3>System Logs</h3>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Date Range:</label>
                            <input type="date" id="logsFromDate">
                            <input type="date" id="logsToDate">
                        </div>
                        <div class="filter-group">
                            <label>Log Type:</label>
                            <select id="logTypeFilter">
                                <option value="">All Logs</option>
                                <option value="error">Error Logs</option>
                                <option value="warning">Warning Logs</option>
                                <option value="info">Info Logs</option>
                            </select>
                        </div>
                        <div class="report-actions">
                            <button class="report-btn" onclick="viewErrorLogs()">
                                <i class="fas fa-file-alt"></i> View Logs
                            </button>
                            <button class="report-btn" onclick="downloadLogsPDF()">
                                <i class="fas fa-download"></i> PDF
                            </button>
                        </div>
                    </div>
                    <div id="systemLogsOutput" class="report-output"></div>
                </div>
                
                <!-- Sales Report Section -->
                <div class="report-section">
                    <h3>Sales Report</h3>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Date Range:</label>
                            <input type="date" id="salesFromDate">
                            <input type="date" id="salesToDate">
                        </div>
                        <div class="filter-group">
                            <label>Item:</label>
                            <select id="salesItemFilter">
                                <option value="">All Items</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Sales Level:</label>
                            <select id="salesLevelFilter">
                                <option value="">All Levels</option>
                                <option value="high">High Sales</option>
                                <option value="low">Low Sales</option>
                            </select>
                        </div>
                        <div class="report-actions">
                            <button class="report-btn" onclick="generateSalesReport()">
                                <i class="fas fa-sync"></i> Generate
                            </button>
                            <button class="report-btn" onclick="downloadSalesPDF()">
                                <i class="fas fa-download"></i> PDF
                            </button>
                        </div>
                    </div>
                    <div id="salesReportOutput" class="report-output"></div>
                </div>

                <!-- Inventory Report Section -->
                <div class="report-section">
                    <h3>Inventory Report</h3>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Date Range:</label>
                            <input type="date" id="inventoryFromDate">
                            <input type="date" id="inventoryToDate">
                        </div>
                        <div class="filter-group">
                            <label>Item:</label>
                            <select id="inventoryItemFilter">
                                <option value="">All Items</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Stock Level:</label>
                            <select id="stockLevelFilter">
                                <option value="">All Levels</option>
                                <option value="high">High Stock</option>
                                <option value="low">Low Stock</option>
                                <option value="critical">Critical Level</option>
                            </select>
                        </div>
                        <div class="report-actions">
                            <button class="report-btn" onclick="generateInventoryReport()">
                                <i class="fas fa-sync"></i> Generate
                            </button>
                            <button class="report-btn" onclick="downloadInventoryPDF()">
                                <i class="fas fa-download"></i> PDF
                            </button>
                        </div>
                    </div>
                    <div id="inventoryReportOutput" class="report-output"></div>
                </div>

                <!-- Sales History Section -->
                <div class="report-section">
                    <h3>Sales History</h3>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label>Date Range:</label>
                            <input type="date" id="historyFromDate">
                            <input type="date" id="historyToDate">
                        </div>
                        <div class="report-actions">
                            <button class="report-btn" onclick="filterSalesHistory()">
                                <i class="fas fa-filter"></i> Filter
                            </button>
                        </div>
                    </div>
                    <div id="salesHistory" class="report-output"></div>
                </div>
            </div>

            <!-- Notifications Module -->
            <div id="notificationModule" class="module" style="display: none; text-align: left; margin-left: 0; width: 100%;">
                <h2 style="text-align:left; margin-top:0;">Notifications</h2>
                <div class="form-section" style="text-align: left; width: 100%; min-height: 500px; margin-top: 0; margin-left: 0;">
                    <h3 style="text-align:left;">System Notifications</h3>
                    <div id="notificationOutput" class="notification-output" style="text-align:left; height: 100%;">
                        <!-- Notifications will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Access Denied Module -->
            <div id="accessDeniedModule" class="module" style="display:none; text-align:center;"></div>
        </div>

        <!-- Remove the footer and leave only the clock -->
        <div id="clock" style="position: fixed; right: 10px; bottom: 4px; padding: 4px 10px; background: #fff; border: 1px solid #d4c9b8; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); font-size: 13px; z-index: 100;">Loading date & time...</div>
    </div>

    <!-- JavaScript Files -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/sales.js"></script>
    <script src="js/inventory.js"></script>
    <script src="js/userManagement.js"></script>
    <script src="js/maintenance.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Initialize subcategories when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize inventory subcategories
            const inventoryCategory = document.getElementById('inventoryCategory');
            if (inventoryCategory) {
                updateInventorySubcategories();
                inventoryCategory.addEventListener('change', updateInventorySubcategories);
            }

            // Initialize sales subcategories
            const salesCategory = document.getElementById('salesCategory');
            if (salesCategory) {
                updateSalesSubcategories();
                salesCategory.addEventListener('change', updateSalesSubcategories);
            }

            const searchButton = document.querySelector('.search-icon');
            if (searchButton) {
                searchButton.addEventListener('click', searchSalesInventory);
            }
        });

        window.searchSalesInventory = searchSalesInventory;
        window.selectItem = selectItem;
        window.addToOrder = addToOrder;
        window.removeOrderItem = removeOrderItem;
        window.saveOrder = saveOrder;
        window.startEdit = startEdit;
        window.saveEdit = saveEdit;
    </script>
    <style>
        .order-section select {
            width: auto !important;
            min-width: 150px;
        }
        #salesCategory, #salesSubcategory, #salesSize, #salesUnit {
            width: auto !important;
            min-width: 150px;
        }
        .select2-container {
            width: auto !important;
            min-width: 150px !important;
        }
    </style>
</body>
</html> 